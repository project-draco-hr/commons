def _calculate_sources(self, thrift_targets):
    bases = set()
    sources = set()

    def collect_sources(target):
        if ThriftGen._is_thrift(target):
            bases.add(target.target_base)
            sources.update((os.path.join(target.target_base, source) for source in target.sources))
    for target in thrift_targets:
        target.walk(collect_sources)
    sources = self._find_root_sources(bases, sources)
    return (bases, sources)
