def __init__(self, context):
    CodeGen.__init__(self, context)
    self.thrift_binary = select_binary(context.config.get('thrift-gen', 'supportdir'), context.config.get('thrift-gen', 'version'), 'thrift')
    self.output_dir = (context.options.thrift_gen_create_outdir or context.config.get('thrift-gen', 'workdir'))
    self.strict = context.config.getbool('thrift-gen', 'strict')
    self.verbose = context.config.getbool('thrift-gen', 'verbose')

    def create_geninfo(key):
        gen_info = context.config.getdict('thrift-gen', key)
        gen = gen_info['gen']
        deps = OrderedSet()
        for dep in gen_info['deps']:
            deps.update(context.resolve(dep))
        return ThriftGen.GenInfo(gen, deps)
    self.gen_java = create_geninfo('java')
    self.gen_python = create_geninfo('python')
    self.gen_langs = set(context.options.thrift_gen_langs)
    for lang in ('java', 'python'):
        if self.context.products.isrequired(lang):
            self.gen_langs.add(lang)
