def find_includes(bases, source):
    all_bases = [os.path.dirname(source)]
    all_bases.extend(bases)
    includes = set()
    with open(source, 'r') as thrift:
        for line in thrift.readlines():
            match = INCLUDE_PARSER.match(line)
            if match:
                capture = match.group(1)
                for base in all_bases:
                    include = os.path.join(base, capture)
                    if os.path.exists(include):
                        log.debug(('%s has include %s' % (source, include)))
                        includes.add(include)
    return includes
