@classmethod
def for_target(cls, target, transitive, class_genmap):
    classnames = set()

    def add_classnames(tgt):
        if cls.maybe_has_args(tgt):
            class_mapping = class_genmap.get(tgt)
            if class_mapping:
                for (base, classes) in class_mapping.rel_paths():
                    for clazz in classes:
                        classnames.add(clazz.replace('.class', '').replace('/', '.'))
    if transitive:
        target.walk(add_classnames)
    else:
        add_classnames(target)
    return cls(classnames)
