def test_download(self):
    (downloaded, path) = self.expect_download()
    try:
        with open(path) as fp:
            self.assertEqual(downloaded, fp.read())
    finally:
        os.unlink(path)
