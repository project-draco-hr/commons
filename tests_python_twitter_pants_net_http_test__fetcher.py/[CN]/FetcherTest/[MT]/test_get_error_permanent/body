def test_get_error_permanent(self):
    self.requests.get('http://foo', stream=True, timeout=60).AndRaise(requests.TooManyRedirects)
    self.mox.ReplayAll()
    with pytest.raises(self.fetcher.PermanentError) as e:
        self.fetcher.fetch('http://foo', self.listener, chunk_size=Amount(1, Data.KB), timeout=Amount(1, Time.MINUTES))
    self.assertTrue((e.value.response_code is None))
