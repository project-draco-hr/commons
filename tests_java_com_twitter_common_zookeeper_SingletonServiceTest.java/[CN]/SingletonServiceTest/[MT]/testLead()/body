{
  Pair<InetSocketAddress,Map<String,InetSocketAddress>> endpoints=getEndpoints("foo");
  Capture<Leader> leaderCapture=new Capture<Leader>();
  expect(candidate.offerLeadership(capture(leaderCapture))).andReturn(null);
  expect(serverSet.join(endpoints.getFirst(),endpoints.getSecond(),Status.STARTING)).andReturn(endpointStatus);
  listener.onLeading(endpointStatus);
  endpointStatus.update(Status.ALIVE);
  endpointStatus.update(Status.STOPPED);
  control.replay();
  newLeader("foo");
  endpointStatus.update(Status.ALIVE);
  endpointStatus.update(Status.STOPPED);
  leaderCapture.getValue().onElected(abdicate);
}
