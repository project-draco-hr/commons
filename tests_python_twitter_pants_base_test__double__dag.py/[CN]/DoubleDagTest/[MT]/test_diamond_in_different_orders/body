def test_diamond_in_different_orders(self):
    a = MockTarget('a')
    b = MockTarget('b', [a])
    c = MockTarget('c', [a])
    d = MockTarget('d', [c, b])

    def test_diamond_dag(dag):
        self.assertEquals(dag._roots, set([dag.lookup(d)]))
        self.assertEquals(dag.leaves, set([dag.lookup(a)]))
        self.check_dag_node(dag, d, [b, c], [])
        self.check_dag_node(dag, c, [a], [d])
        self.check_dag_node(dag, b, [a], [d])
        self.check_dag_node(dag, a, [], [b, c])
    test_diamond_dag(make_dag([a, b, c, d]))
    test_diamond_dag(make_dag([d, c, b, a]))
    test_diamond_dag(make_dag([b, d, a, c]))
