def test_simple_dag(self):
    a = MockTarget('a')
    b = MockTarget('b', [a])
    c = MockTarget('c', [b])
    d = MockTarget('d', [c, a])
    e = MockTarget('e', [d])

    def test_dag(dag):
        self.assertEquals(dag._roots, set([dag.lookup(e)]))
        self.assertEquals(dag.leaves, set([dag.lookup(a)]))
        self.check_dag_node(dag, e, [d], [])
        self.check_dag_node(dag, d, [a, c], [e])
        self.check_dag_node(dag, c, [b], [d])
        self.check_dag_node(dag, b, [a], [c])
        self.check_dag_node(dag, a, [], [b, d])
    test_dag(make_dag([e, d, c, b, a]))
    test_dag(make_dag([a, b, c, d, e]))
    test_dag(make_dag([a, b, e, d, c]))
    test_dag(make_dag([d, a, c, e, b]))
