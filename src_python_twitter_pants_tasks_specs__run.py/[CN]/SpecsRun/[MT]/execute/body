def execute(self, targets):
    if (not self.skip):

        def run_tests(main, args):
            classpath = profile_classpath(self.profile)
            classpath.extend((os.path.join(get_buildroot(), path) for path in ('src/resources', 'tests/resources')))
            with self.context.state('classpath', []) as cp:
                classpath.extend((jar for (conf, jar) in cp if (conf in self.confs)))
            result = runjava(jvmargs=self.java_args, classpath=classpath, main=main, args=args)
            if (result != 0):
                raise TaskError()
        args = []
        if self.color:
            args.append('--color')
        if self.tests:
            args.append('--classes')
            args.append(','.join(self.tests))
            run_tests('run', args)
        else:
            with safe_args(self.calculate_tests(targets)) as tests:
                if tests:
                    args.append(('--specs-files=%s' % ','.join(tests)))
                    run_tests('com.twitter.common.testing.ExplicitSpecsRunnerMain', args)
