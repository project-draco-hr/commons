def test_href_translation():
    VERSIONS = ['0.4.0', '0.4.1', '0.5.0', '0.6.0']

    def fake_link(version):
        return ('http://www.example.com/foo/bar/psutil-%s.tar.gz' % version)
    fc = FakeCrawler([fake_link(v) for v in VERSIONS])
    ob = Obtainer(fc, [], [])
    for v in VERSIONS:
        pkgs = list(ob.iter(Requirement.parse(('psutil==%s' % v))))
        assert (len(pkgs) == 1), ('Version: %s' % v)
        assert (pkgs[0] == SourcePackage(fake_link(v)))
    assert (list(ob.iter(Requirement.parse('psutil>=0.5.0'))) == [SourcePackage(fake_link('0.6.0')), SourcePackage(fake_link('0.5.0'))])
    assert (list(ob.iter(Requirement.parse('psutil'))) == [SourcePackage(fake_link(v)) for v in reversed(VERSIONS)])
