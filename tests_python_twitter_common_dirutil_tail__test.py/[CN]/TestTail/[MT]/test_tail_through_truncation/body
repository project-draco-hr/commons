def test_tail_through_truncation(self):
    self.write_to_fp('hello')
    self._thread.clock().tick()
    assert (self._thread.clear() == ['hello\n'])
    self.write_to_fp('hello 2')
    self._thread.clock().tick()
    assert (self._thread.clear() == ['hello 2\n'])
    self._fp.truncate(0)
    self.write_to_fp('hello 3')
    self._thread.clock().tick()
    assert (self._thread.clear() == ['hello 3\n'])
