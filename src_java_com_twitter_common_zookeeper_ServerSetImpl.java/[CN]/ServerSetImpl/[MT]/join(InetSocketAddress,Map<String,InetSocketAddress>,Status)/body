{
  Preconditions.checkNotNull(endpoint);
  Preconditions.checkNotNull(additionalEndpoints);
  Preconditions.checkNotNull(status);
  final MemberStatus memberStatus=new MemberStatus(endpoint,additionalEndpoints,status);
  Supplier<byte[]> serviceInstanceSupplier=new Supplier<byte[]>(){
    @Override public byte[] get(){
      return memberStatus.serializeServiceInstance();
    }
  }
;
  final Membership membership=group.join(serviceInstanceSupplier);
  return new EndpointStatus(){
    @Override public void update(    Status status) throws UpdateException {
      Preconditions.checkNotNull(status);
      memberStatus.updateStatus(membership,status);
    }
  }
;
}
