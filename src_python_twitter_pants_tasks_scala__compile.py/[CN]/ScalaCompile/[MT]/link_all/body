def link_all(self, srcdir, dstdir):
    safe_mkdir(dstdir)
    for (dirpath, dirnames, filenames) in os.walk(srcdir):
        for d in [os.path.join(dirpath, x) for x in dirnames]:
            dir = os.path.join(dstdir, os.path.relpath(d, srcdir))
            if (not os.path.isdir(dir)):
                os.mkdir(dir)
        for f in [os.path.join(dirpath, x) for x in filenames]:
            outfile = os.path.join(dstdir, os.path.relpath(f, srcdir))
            if os.path.exists(outfile):
                os.unlink(outfile)
            os.link(f, outfile)
