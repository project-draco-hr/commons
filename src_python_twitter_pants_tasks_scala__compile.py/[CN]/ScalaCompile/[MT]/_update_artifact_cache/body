def _update_artifact_cache(self, vts_artifact_pairs):
    vts_artifactfiles_pairs = []
    with self.context.new_workunit(name='cacheprep'):
        with self.context.new_workunit(name='relativize', labels=[WorkUnit.MULTITOOL]):
            for (vts, artifact) in vts_artifact_pairs:
                if (os.path.exists(artifact.analysis_file) and self._zinc_utils.relativize_analysis_file(artifact.analysis_file, artifact.portable_analysis_file)):
                    raise TaskError(('Zinc failed to relativize analysis file: %s' % artifact.analysis_file))
                artifact_files = [artifact.classes_dir, artifact.portable_analysis_file]
                vts_artifactfiles_pairs.append((vts, artifact_files))
    self.update_artifact_cache(vts_artifactfiles_pairs)
