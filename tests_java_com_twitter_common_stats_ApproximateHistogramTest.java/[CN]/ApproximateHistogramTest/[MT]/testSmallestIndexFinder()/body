{
  ApproximateHistogram hist=new ApproximateHistogram();
  hist.init(b,h);
  for (int i=1; i <= 3; i++) {
    hist.add(i);
  }
  for (int i=1; i <= 3; i++) {
    int j=hist.smallest(3,0,hist.indices);
    int idx=hist.indices[j];
    hist.indices[j]+=1;
    assertEquals(i,hist.buffer[j][idx]);
  }
  Arrays.fill(hist.indices,0);
  for (int i=4; i <= 2 * b; i++) {
    hist.add(i);
  }
  for (int i=1; i <= 2 * b; i++) {
    int j=hist.smallest(b,b,hist.indices);
    int idx=hist.indices[j];
    hist.indices[j]+=1;
    assertEquals(i,hist.buffer[j][idx]);
  }
  Arrays.fill(hist.indices,0);
  hist.add(2 * b + 1);
  for (int i=2; i <= 2 * b + 1; i+=2) {
    int j=hist.smallest(1,0,hist.indices);
    int idx=hist.indices[j];
    hist.indices[j]+=1;
    assertEquals(i,hist.buffer[j][idx]);
  }
  int j=hist.smallest(1,0,hist.indices);
  int idx=hist.indices[j];
  hist.indices[j]+=1;
  assertEquals(2 * b + 1,hist.buffer[j][idx]);
}
