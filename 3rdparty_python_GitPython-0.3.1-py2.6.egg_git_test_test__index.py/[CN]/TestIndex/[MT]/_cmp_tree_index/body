def _cmp_tree_index(self, tree, index):
    if isinstance(tree, str):
        tree = self.rorepo.commit(tree).tree
    num_blobs = 0
    blist = list()
    for blob in tree.traverse(predicate=(lambda e, d: (e.type == 'blob')), branch_first=False):
        assert ((blob.path, 0) in index.entries)
        blist.append(blob)
    if (len(blist) != len(index.entries)):
        iset = set((k[0] for k in index.entries.keys()))
        bset = set((b.path for b in blist))
        raise AssertionError(('CMP Failed: Missing entries in index: %s, missing in tree: %s' % ((bset - iset), (iset - bset))))
