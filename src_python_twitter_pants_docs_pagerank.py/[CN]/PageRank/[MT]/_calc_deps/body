def _calc_deps(self, targets, dependencies_by_target, dependees_by_target):
    for target in filter((lambda x: hasattr(x, 'dependencies')), targets):
        if (not dependencies_by_target.has_key(target)):
            for dependency in target.dependencies:
                for resolved in dependency.resolve():
                    if is_concrete(resolved):
                        dependencies_by_target[target].add(resolved)
        for dependency in target.dependencies:
            for resolved in dependency.resolve():
                if is_concrete(resolved):
                    dependees_by_target[resolved].add(target)
