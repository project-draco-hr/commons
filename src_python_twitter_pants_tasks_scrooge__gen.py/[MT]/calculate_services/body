def calculate_services(source):
    'Calculates the services generated for the given thrift IDL source.\n  Returns an interable of services\n  '
    with open(source, 'r') as thrift:
        namespaces = dict()
        types = defaultdict(set)
        for line in thrift:
            match = NAMESPACE_PARSER.match(line)
            if match:
                lang = match.group(1)
                namespace = match.group(2)
                namespaces[lang] = namespace
            else:
                match = TYPE_PARSER.match(line)
                if match:
                    typename = match.group(1)
                    name = match.group(2)
                    types[typename].add(name)
        return types['service']
