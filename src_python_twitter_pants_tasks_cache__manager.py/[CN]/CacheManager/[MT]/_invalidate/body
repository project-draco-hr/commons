def _invalidate(self, target, cache_key, indirect=False):
    self._invalidator.invalidate(cache_key)
    if (target in self._targets):
        if indirect:
            self.invalidated_files += cache_key.num_sources
            self.invalidated_targets += 1
        else:
            self.changed_files += cache_key.num_sources
            self.changed_targets += 1
    else:
        self.foreign_invalidated_targets += 1
