def _sources_hash(self, paths):
    'Generate SHA1 digest from the content of all files under the given paths.'
    sha = hashlib.sha1()
    for (relative_filename, filename) in self._walk_paths(paths):
        with open(filename, 'rb') as fd:
            sha.update(Compatibility.to_bytes(relative_filename))
            sha.update(fd.read())
    return sha
