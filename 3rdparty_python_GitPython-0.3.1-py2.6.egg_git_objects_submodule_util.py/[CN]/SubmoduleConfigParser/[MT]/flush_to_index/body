def flush_to_index(self):
    'Flush changes in our configuration file to the index'
    assert (self._smref is not None)
    assert (not isinstance(self._file_or_files, StringIO))
    sm = self._smref()
    if (sm is not None):
        index = self._index
        if (index is None):
            index = sm.repo.index
        index.add([sm.k_modules_file], write=self._auto_write)
        sm._clear_cache()
