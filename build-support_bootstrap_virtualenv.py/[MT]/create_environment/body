def create_environment(home_dir, site_packages=True, clear=False, unzip_setuptools=False, use_distribute=False, prompt=None, search_dirs=None, never_download=False):
    '\n    Creates a new environment in ``home_dir``.\n\n    If ``site_packages`` is true (the default) then the global\n    ``site-packages/`` directory will be on the path.\n\n    If ``clear`` is true (default False) then the environment will\n    first be cleared.\n    '
    (home_dir, lib_dir, inc_dir, bin_dir) = path_locations(home_dir)
    py_executable = os.path.abspath(install_python(home_dir, lib_dir, inc_dir, bin_dir, site_packages=site_packages, clear=clear))
    install_distutils(home_dir)
    if (use_distribute or os.environ.get('VIRTUALENV_USE_DISTRIBUTE')):
        install_distribute(py_executable, unzip=unzip_setuptools, search_dirs=search_dirs, never_download=never_download)
    else:
        install_setuptools(py_executable, unzip=unzip_setuptools, search_dirs=search_dirs, never_download=never_download)
    install_pip(py_executable, search_dirs=search_dirs, never_download=never_download)
    install_activate(home_dir, bin_dir, prompt)
