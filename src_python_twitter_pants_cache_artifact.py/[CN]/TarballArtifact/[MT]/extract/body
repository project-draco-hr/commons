def extract(self):
    try:
        with open_tar(self._tarfile, 'r', errorlevel=2) as tarin:
            paths = []
            dirs = set()
            for tarinfo in tarin.getmembers():
                paths.append(tarinfo.name)
                if tarinfo.isdir():
                    dirs.add(tarinfo.name)
                else:
                    dirs.add(os.path.dirname(tarinfo.name))
            for d in dirs:
                try:
                    os.makedirs(os.path.join(self._artifact_root, d))
                except OSError as e:
                    if (e.errno != errno.EEXIST):
                        raise
            tarin.extractall(self._artifact_root)
            self._relpaths.update(paths)
    except tarfile.ReadError as e:
        raise ArtifactError(e.message)
