def create_artifact_cache(log, artifact_root, spec):
    "Returns an artifact cache for the specified spec.\n\n  spec can be:\n    - a path to a file-based cache root.\n    - a URL of a RESTful cache root.\n    - a bar-separated list of URLs, where we'll pick the one with the best ping times.\n    - A list of the above, for a combined cache.\n  "
    if (not spec):
        raise ValueError('Empty artifact cache spec')
    if isinstance(spec, basestring):
        if spec.startswith('/'):
            log.info(('Using local artifact cache at %s' % spec))
            return FileBasedArtifactCache(log, artifact_root, spec)
        elif (spec.startswith('http://') or spec.startswith('https://')):
            best_url = select_best_url(spec, Pinger(), log)
            log.info(('Using remote artifact cache at %s' % best_url))
            return RESTfulArtifactCache(log, artifact_root, best_url)
        else:
            raise ValueError(('Invalid artifact cache spec: %s' % spec))
    elif isinstance(spec, (list, tuple)):
        caches = [create_artifact_cache(log, artifact_root, x) for x in spec]
        return CombinedArtifactCache(caches)
