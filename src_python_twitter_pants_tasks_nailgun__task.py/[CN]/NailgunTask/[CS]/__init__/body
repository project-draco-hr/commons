def __init__(self, context, classpath=None, workdir=None):
    Task.__init__(self, context)
    self._classpath = classpath
    self._nailgun_bootstrap_tools = context.config.getlist('nailgun', 'bootstrap-tools', default=[':nailgun-server'])
    context.products.require_data('jvm_build_tools_classpath_callbacks')
    self._bootstrap_utils.register_jvm_build_tools(self._nailgun_bootstrap_tools)
    self._ng_server_args = context.config.getlist('nailgun', 'args')
    self._daemon = context.options.nailgun_daemon
    workdir = (workdir or context.config.get('nailgun', 'workdir'))
    self._identifier_arg = ('-Dpants.ng.identifier=%s' % os.path.relpath(workdir, get_buildroot()))
    self._current_pidport = None
    self._ng_out = os.path.join(workdir, 'stdout')
    self._ng_err = os.path.join(workdir, 'stderr')
    self._spawn_lock = threading.Lock()
