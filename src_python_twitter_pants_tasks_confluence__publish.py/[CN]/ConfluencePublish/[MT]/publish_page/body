def publish_page(self, address, space, title, content, parent=None):
    body = (textwrap.dedent('\n\n    <!-- DO NOT EDIT - generated by pants from %s -->\n\n    %s\n    ').strip() % (address, content))
    pageopts = dict(versionComment='updated by pants!')
    wiki = self.login()
    existing = wiki.getpage(space, title)
    if existing:
        if ((not self.force) and (existing['content'].strip() == body.strip())):
            self.context.log.warn(("Skipping publish of '%s' - no changes" % title))
            return
        pageopts['id'] = existing['id']
        pageopts['version'] = existing['version']
    try:
        page = wiki.create_html_page(space, title, body, parent, **pageopts)
        return page['url']
    except ConfluenceError as e:
        raise TaskError(('Failed to update confluence: %s' % e))
