def _run_python_test_suite(self, target, fail_hard=True):
    tests = OrderedSet([])

    def _gather_deps(trg):
        if isinstance(trg, PythonTests):
            tests.add(trg)
        elif isinstance(trg, PythonTestSuite):
            for dependency in trg.dependencies:
                for dep in dependency.resolve():
                    _gather_deps(dep)
    _gather_deps(target)
    failed = False
    for test in tests:
        rv = self._run_python_test(test)
        if (not rv.success):
            failed = True
            if fail_hard:
                return rv
    return PythonTestResult.rc((1 if failed else 0))
