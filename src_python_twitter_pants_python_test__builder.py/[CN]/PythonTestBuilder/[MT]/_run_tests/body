def _run_tests(self, targets):
    fail_hard = ('PANTS_PYTHON_TEST_FAILSOFT' not in os.environ)
    if ('PANTS_PY_COVERAGE' in os.environ):
        fail_hard = False
    failed = False
    for target in targets:
        if isinstance(target, PythonTests):
            rv = self._run_python_test(target)
        elif isinstance(target, PythonTestSuite):
            rv = self._run_python_test_suite(target, fail_hard)
        else:
            raise PythonTestBuilder.InvalidDependencyException(('Invalid dependency in python test target: %s' % target))
        if (not rv.success):
            failed = True
            if fail_hard:
                return rv
    return PythonTestResult.rc((1 if failed else 0))
