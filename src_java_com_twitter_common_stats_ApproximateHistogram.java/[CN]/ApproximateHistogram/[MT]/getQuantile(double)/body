{
  if (count == 0) {
    return 0L;
  }
  int buf0Size=Math.min(bufferSize,leafCount);
  int buf1Size=Math.max(0,leafCount - buf0Size);
  long sum=0;
  long target=(long)(count * q);
  int i=0;
  Arrays.sort(buffer[0],0,buf0Size);
  Arrays.sort(buffer[1],0,buf1Size);
  Arrays.fill(indices,0);
  while (sum < target) {
    i=smallest(buf0Size,buf1Size,indices);
    indices[i]++;
    sum+=weight(i);
  }
  return buffer[i][indices[i] - 1];
}
