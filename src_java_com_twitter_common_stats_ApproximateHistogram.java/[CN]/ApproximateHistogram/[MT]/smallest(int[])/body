{
  int iSmallest=0;
  long smallest=Long.MAX_VALUE;
  for (int i=0; i < buffer.size(); i++) {
    long head=Long.MAX_VALUE;
    if (!buffer.get(i).isEmpty() && indices[i] < buffer.get(i).size()) {
      head=buffer.get(i).get(indices[i]);
    }
    if (head < smallest) {
      smallest=head;
      iSmallest=i;
    }
  }
  indices[iSmallest]+=1;
  return iSmallest;
}
