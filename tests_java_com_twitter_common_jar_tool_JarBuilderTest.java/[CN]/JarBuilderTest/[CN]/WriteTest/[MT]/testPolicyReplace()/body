{
  DuplicateHandler replaceMeaningOfLife=new DuplicateHandler(DuplicateAction.SKIP,DuplicatePolicy.pathMatches("^meaning/of/life$",DuplicateAction.REPLACE));
  File destinationJar=jarBuilder().add(content("1/137"),"meaning/of/life").add(content("!"),"meaning/of/life").add(content("1/137"),"meaning/of/brian").write(false,replaceMeaningOfLife);
  doWithJar(destinationJar,new ExceptionalClosure<JarFile,IOException>(){
    @Override public void execute(    JarFile jar) throws IOException {
      assertListing(jar,"meaning/","meaning/of/","meaning/of/life","meaning/of/brian");
      assertStoredContents(jar,"meaning/of/life","!");
      assertStoredContents(jar,"meaning/of/brian","1/137");
    }
  }
);
  jarBuilder(destinationJar).add(content("42"),"meaning/of/life").add(content("jane"),"meaning/of/life").write(true,replaceMeaningOfLife);
  doWithJar(destinationJar,new ExceptionalClosure<JarFile,IOException>(){
    @Override public void execute(    JarFile jar) throws IOException {
      assertListing(jar,"meaning/","meaning/of/","meaning/of/life","meaning/of/brian");
      assertCompressedContents(jar,"meaning/of/life","jane");
      assertCompressedContents(jar,"meaning/of/brian","1/137");
    }
  }
);
}
