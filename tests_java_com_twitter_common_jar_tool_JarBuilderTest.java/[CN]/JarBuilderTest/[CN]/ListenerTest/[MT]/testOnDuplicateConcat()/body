{
  Listener listener=createMock(Listener.class);
  Capture<Iterable<? extends Entry>> concatenated=new Capture<Iterable<? extends Entry>>();
  listener.onConcat(eq("concatenated/write"),capture(concatenated));
  replay(listener);
  File one=newFile("one");
  File two=newFile("two");
  File three=newFile("three");
  jarBuilder(newFile(),listener).addFile(one,"concatenated/write").addFile(two,"concatenated/write").addFile(three,"concatenated/write").write(false,DuplicateHandler.always(DuplicateAction.CONCAT));
  assertEquals(ImmutableList.of("one","two","three"),FluentIterable.from(concatenated.getValue()).transform(GET_NAME).toList());
}
