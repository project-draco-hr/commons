{
  MorePreconditions.checkNotBlank(name);
  Preconditions.checkNotNull(percentiles);
  Preconditions.checkArgument(percentiles.length > 0,"Must specify at least one percentile.");
  this.sampler=Preconditions.checkNotNull(sampler);
  ImmutableMap.Builder<Integer,SampledStat<Double>> builder=new ImmutableMap.Builder<Integer,SampledStat<Double>>();
  for (int i=0; i < percentiles.length; i++) {
    boolean sortFirst=i == 0;
    boolean flushAfterSampling=i == percentiles.length - 1;
    String statName=String.format("%s_%dth_percentile",name,percentiles[i]);
    SampledStat<Double> stat=new PercentileVar(statName,percentiles[i],sortFirst,flushAfterSampling);
    Stats.export(stat);
    builder.put(percentiles[i],stat);
  }
  this.percentiles=builder.build();
}
