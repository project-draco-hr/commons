def calculate_compile_sources(targets, is_thrift_target):
    'Calculates the set of thrift source files that need to be compiled.\n  It does not exclude sources that are included in other sources.\n\n  A tuple of (include basedirs, thrift sources) is returned.\n\n  :targets: The targets to examine.\n  :is_thrift_target: A predicate to pick out thrift targets for consideration in the analysis.\n  '
    basedirs = set()
    sources = set()

    def collect_sources(target):
        basedirs.add(target.target_base)
        sources.update(target.sources_relative_to_buildroot())
    for target in targets:
        target.walk(collect_sources, predicate=is_thrift_target)
    return (basedirs, sources)
