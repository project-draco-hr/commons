{
  for (  Entry<Class<?>,TestSuite> entry : suites.entrySet()) {
    Class<?> testClass=entry.getKey();
    TestSuite suite=entry.getValue();
    if (suite.wasStarted()) {
      suite.setOut(new String(streamSource.readOut(testClass),Charsets.UTF_8));
      suite.setErr(new String(streamSource.readErr(testClass),Charsets.UTF_8));
      Writer xmlOut=new FileWriter(new File(outdir,String.format("TEST-%s.xml",suite.name)));
      JAXB.marshal(suite,new XmlWriter(xmlOut){
        @Override protected void handleInvalid(        int c) throws IOException {
          out.write(' ');
        }
      }
);
    }
  }
}
