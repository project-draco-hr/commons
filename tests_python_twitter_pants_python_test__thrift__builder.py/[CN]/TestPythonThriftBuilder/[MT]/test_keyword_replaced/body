def test_keyword_replaced(self):
    thrift_contents = dedent('\n      namespace py gen.twitter.tweetypie.tweet\n      struct UrlEntity {\n        1: i16 from\n      }\n    ')
    expected_replaced_contents = dedent('\n      namespace py gen.twitter.tweetypie.tweet\n      struct UrlEntity {\n        1: i16 from_\n      }\n    ')
    builder = PythonThriftBuilder(target=self.target('test_thrift_replacement:one'), root_dir=self.build_root, config=create_config(sample_ini=sample_ini_test))
    m = mock_open(read_data=thrift_contents)
    with patch('__builtin__.open', m, create=True):
        builder = PythonThriftBuilder(target=self.target('test_thrift_replacement:one'), root_dir=self.build_root, config=create_config(sample_ini=sample_ini_test))
        builder._modify_thrift('thrift_dummmy.thrift')
        expected_open_call_list = [call('thrift_dummmy.thrift'), call('thrift_dummmy.thrift', 'w')]
        (m.call_args_list == expected_open_call_list)
        mock_file_handle = m()
        mock_file_handle.write.assert_called_once_with(expected_replaced_contents)
