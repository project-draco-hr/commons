def __init__(self, endpoint, zk=None, watcher=None, retries=None):
    self._error = None
    self._endpoint = endpoint
    self._watcher = watcher
    self._lock = threading.Lock()
    self._endpoints = set()
    options = app.get_options()
    self._retries = (options.serverset_retries if (retries is None) else retries)
    self._zk = (zk or ZooKeeper())
    self._start()
