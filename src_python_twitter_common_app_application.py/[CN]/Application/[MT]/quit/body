def quit(self, rc, exit_function=sys.exit):
    self._debug_log('Shutting application down.')
    self._teardown_modules()
    import threading
    nondaemons = 0
    for thr in threading.enumerate():
        self._debug_log(('  Active thread%s: %s' % ((' (daemon)' if thr.isDaemon() else ''), thr)))
        if ((thr is not threading.current_thread()) and (not thr.isDaemon())):
            nondaemons += 1
    if nondaemons:
        self._debug_log('More than one active non-daemon thread, your application may hang!')
    else:
        self._debug_log('Exiting cleanly.')
    exit_function(rc)
