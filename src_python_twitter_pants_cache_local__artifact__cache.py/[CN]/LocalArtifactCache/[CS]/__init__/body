def __init__(self, log, artifact_root, cache_root, compress=True, copy_fn=None, read_only=False):
    '\n    cache_root: The locally cached files are stored under this directory.\n    copy_fn: An optional function with the signature copy_fn(absolute_src_path, relative_dst_path) that\n        will copy cached files into the desired destination. If unspecified, a simple file copy is used.\n    '
    ArtifactCache.__init__(self, log, artifact_root, read_only)
    self._cache_root = os.path.expanduser(cache_root)
    self._compress = compress

    def copy(src, rel_dst):
        dst = os.path.join(self.artifact_root, rel_dst)
        safe_mkdir_for(dst)
        shutil.copy(src, dst)
    self._copy_fn = (copy_fn or copy)
    safe_mkdir(self._cache_root)
