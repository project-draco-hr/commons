def try_insert(self, cache_key, paths):
    tarfile = self._cache_file_for_key(cache_key)
    safe_mkdir_for(tarfile)
    tarfile_tmp = (((tarfile + '.') + str(uuid.uuid4())) + '.tmp')
    if os.path.exists(tarfile_tmp):
        os.unlink(tarfile_tmp)
    artifact = TarballArtifact(self.artifact_root, tarfile_tmp, self._compress)
    artifact.collect(paths)
    if os.path.exists(tarfile):
        os.unlink(tarfile)
    os.rename(tarfile_tmp, tarfile)
