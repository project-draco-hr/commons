def _subprocess_call(cmd_with_args, call=subprocess.call, workunit_factory=None, workunit_name=None, **kwargs):
    cmd_str = ' '.join(cmd_with_args)
    log.debug(('Executing: %s' % cmd_str))
    if workunit_factory:
        workunit_labels = [WorkUnit.TOOL, WorkUnit.JVM]
        with workunit_factory(name=workunit_name, labels=workunit_labels, cmd=cmd_str) as workunit:
            try:
                ret = call(cmd_with_args, stdout=workunit.output('stdout'), stderr=workunit.output('stderr'), **kwargs)
                workunit.set_outcome((WorkUnit.FAILURE if ret else WorkUnit.SUCCESS))
                return ret
            except OSError as e:
                if (errno.E2BIG == e.errno):
                    workunit.set_outcome(WorkUnit.SUCCESS)
    else:
        return call(cmd_with_args, **kwargs)
