def find_all_java_sysprops():
    'Runs a JVM to get at its standard system properties.'
    with temporary_dir() as tmpdir:
        with open(os.path.join(tmpdir, 'X.java'), 'w') as srcfile:
            srcfile.write('\n        class X {\n          public static void main(String[] argv) {\n            java.util.Properties props = System.getProperties();\n            // We don\'t use Properties.list() because it truncates long values.\n            for (String key : props.stringPropertyNames())\n              System.out.println(key + "=" + props.getProperty(key));\n          }\n        }')
        subprocess.Popen(['javac', '-d', tmpdir, srcfile.name], stdout=subprocess.PIPE, stderr=subprocess.PIPE).communicate()
        output = subprocess.Popen(['java', '-cp', tmpdir, 'X'], stdout=subprocess.PIPE, stderr=subprocess.PIPE).communicate()[0]
        lines = output.split('\n')
        ret = {}
        for line in lines:
            (key, _, val) = line.partition('=')
            ret[key] = val
        return ret
