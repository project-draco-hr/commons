def _calculate_classpath(self, targets):

    def is_jardependant(target):
        return (target.is_jar or target.is_jvm)
    jars = {}
    excludes = set()

    def add_jar(jar):
        coordinate = (jar.org, jar.name)
        existing = jars.get(coordinate)
        jars[coordinate] = (jar if (not existing) else self._resolve_conflict(existing=existing, proposed=jar))

    def collect_jars(target):
        if target.is_jar:
            add_jar(target)
        elif target.jar_dependencies:
            for jar in target.jar_dependencies:
                if jar.rev:
                    add_jar(jar)
        if (target.is_jvm and target.excludes):
            excludes.update(target.excludes)
    for target in targets:
        target.walk(collect_jars, is_jardependant)
    return (jars.values(), excludes)
