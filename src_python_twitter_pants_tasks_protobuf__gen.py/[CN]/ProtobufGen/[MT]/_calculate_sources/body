def _calculate_sources(self, targets):
    bases = set()
    sources = set()

    def collect_sources(target):
        if self.is_gentarget(target):
            bases.add(target.target_base)
            sources.update((os.path.join(target.target_base, source) for source in target.sources))
    for target in targets:
        target.walk(collect_sources)
    return (bases, sources)
