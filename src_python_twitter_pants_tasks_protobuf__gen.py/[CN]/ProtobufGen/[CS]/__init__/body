def __init__(self, context):
    CodeGen.__init__(self, context)
    self.protobuf_binary = select_binary(context.config.get('protobuf-gen', 'supportdir'), context.config.get('protobuf-gen', 'version'), 'protoc')
    self.output_dir = (context.options.protobuf_gen_create_outdir or context.config.get('protobuf-gen', 'workdir'))

    def resolve_deps(key):
        deps = OrderedSet()
        for dep in context.config.getlist('protobuf-gen', 'javadeps'):
            deps.update(context.resolve(dep))
        return deps
    self.javadeps = resolve_deps('javadeps')
    self.java_out = os.path.join(self.output_dir, 'gen-java')
    self.pythondeps = resolve_deps('pythondeps')
    self.py_out = os.path.join(self.output_dir, 'gen-py')
    self.gen_langs = set(context.options.protobuf_gen_langs)
