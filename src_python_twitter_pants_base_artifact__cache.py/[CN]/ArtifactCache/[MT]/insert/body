def insert(self, cache_key, build_artifacts):
    "Cache the output of a build.\n\n    If there is an existing set of artifacts for this key they are deleted.\n\n    TODO: Check that they're equal? If they aren't it's a grave bug, since the key is supposed\n    to be a fingerprint of all possible inputs to the build.\n\n    cache_key: A CacheKey object.\n    build_artifacts: List of paths to generated artifacts. These must be under pants_workdir.\n    "
    build_artifacts_that_exist = filter((lambda f: os.path.exists(f)), build_artifacts)
    try:
        self.try_insert(cache_key, build_artifacts_that_exist)
    except Exception as e:
        try:
            self.delete(cache_key)
        except Exception:
            print ('IMPORTANT: failed to delete %s on error. Your artifact cache may be corrupted. Please delete manually.' % cache_key)
        if self.context:
            self.context.log.error(traceback.format_exc())
        else:
            traceback.print_exc()
        raise e
