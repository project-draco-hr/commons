def create_artifact_cache(context, artifact_root, spec):
    "Returns an artifact cache for the specified spec.\n\n  If config is a string, it's interpreted as a path or URL prefix to a cache root. If it's a list of\n  strings, it returns an appropriate combined cache.\n  "
    if (not spec):
        raise ValueError('Empty artifact cache spec')
    if isinstance(spec, Compatibility.string):
        if spec.startswith('/'):
            return FileBasedArtifactCache(context, artifact_root, spec)
        elif (spec.startswith('http://') or spec.startswith('https://')):
            return RESTfulArtifactCache(context, artifact_root, spec)
        else:
            raise ValueError(('Invalid artifact cache spec: %s' % spec))
    elif isinstance(spec, (list, tuple)):
        caches = [create_artifact_cache(context, artifact_root, x) for x in spec]
        return CombinedArtifactCache(caches)
