def _setup_logging_partitions(handler_class, filename):
    _GLOG_FILTERS = {logging.DEBUG: GlogLevelFilter(logging.DEBUG), logging.INFO: GlogLevelFilter(logging.INFO), logging.WARN: GlogLevelFilter(logging.WARN), logging.FATAL: GlogLevelFilter(logging.FATAL), logging.ERROR: GlogLevelFilter(logging.ERROR), }
    logroot = LogOptions.log_dir()
    handlers = []
    for filter_type in _GLOG_FILTERS:
        if ((LogOptions.disk_log_level() is not None) and (filter_type >= LogOptions.disk_log_level())):
            logfile = os.path.join(logroot, filename)
            logfile = '.'.join([logfile, getpass.getuser(), logging.getLevelName(filter_type)])
            file_handler = handler_class(logfile)
            file_handler.setFormatter(GlogFormatter())
            file_handler.addFilter(_GLOG_FILTERS[filter_type])
            handlers.append(file_handler)
    return handlers
