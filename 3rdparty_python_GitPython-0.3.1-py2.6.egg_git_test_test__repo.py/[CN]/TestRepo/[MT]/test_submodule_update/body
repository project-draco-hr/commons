@with_rw_repo('HEAD', bare=False)
def test_submodule_update(self, rwrepo):
    rwrepo._bare = True
    self.failUnlessRaises(InvalidGitRepositoryError, rwrepo.submodule_update)
    rwrepo._bare = False
    sm = rwrepo.submodules[0]
    sm = rwrepo.create_submodule('my_new_sub', 'some_path', join_path_native(self.rorepo.working_tree_dir, sm.path))
    assert isinstance(sm, Submodule)
