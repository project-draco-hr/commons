{
  final Multimap<String,ReadableEntry> entries=LinkedListMultimap.create();
  if (target.exists() && target.length() > 0) {
    final InputSupplier<JarFile> jarSupplier=closer.register(new JarSupplier(target));
    try {
      enumerateJarEntries(target,new ExceptionalClosure<JarEntry,IOException>(){
        @Override public void execute(        JarEntry jarEntry) throws IOException {
          String entryPath=jarEntry.getName();
          InputSupplier<InputStream> contents=entrySupplier(jarSupplier,jarEntry);
          if (JarFile.MANIFEST_NAME.equals(entryPath)) {
            if (manifest == null) {
              manifest=contents;
            }
          }
 else           if (!jarEntry.isDirectory()) {
            entries.put(entryPath,new ReadableJarEntry(NamedInputSupplier.create(jarSource(target),entryPath,contents),jarEntry));
          }
        }
      }
);
    }
 catch (    IOException e) {
      throw new IndexingException(target,e);
    }
  }
  for (  ExceptionalClosure<Multimap<String,ReadableEntry>,JarBuilderException> addition : additions) {
    addition.execute(entries);
  }
  return entries;
}
