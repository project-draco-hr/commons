def test_cache_spec_parsing(self):
    artifact_root = '/bogus/artifact/root'

    def check(expected_type, spec):
        cache = create_artifact_cache(MockLogger(), artifact_root, spec, 'TestTask', False, False)
        self.assertTrue(isinstance(cache, expected_type))
        self.assertEquals(cache.artifact_root, artifact_root)
    with temporary_dir() as tmpdir:
        cachedir = os.path.join(tmpdir, 'cachedir')
        check(LocalArtifactCache, cachedir)
        check(RESTfulArtifactCache, 'http://localhost/bar')
        check(CombinedArtifactCache, [cachedir, 'http://localhost/bar'])
