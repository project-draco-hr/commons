def test_client_iteration(self):
    sync_log('test_client_iteration')
    zk = ZooKeeper(self._server.ensemble, timeout_secs=10, logger=sync_log)
    service = ServerSet(zk, SERVICE_PATH)
    client = ServerSetClient(SERVICE_PATH, zk=zk)
    assert (list(client) == [])
    service.register(INSTANCE1)
    assert (list(client) == [INSTANCE1])
    service.register(INSTANCE2)
    assert (list(client) == [INSTANCE1, INSTANCE2])
    sync_log('Test over, killing client.')
    zk.close()
