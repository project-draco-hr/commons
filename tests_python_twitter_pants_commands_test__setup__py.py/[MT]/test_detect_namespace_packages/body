def test_detect_namespace_packages():

    def has_ns(stmt):
        with temporary_file() as fp:
            fp.write(stmt)
            fp.flush()
            return SetupPy.declares_namespace_package(fp.name)
    assert (not has_ns(''))
    assert (not has_ns('add(1, 2); foo(__name__); self.shoot(__name__)'))
    assert (not has_ns('declare_namespace(bonk)'))
    assert has_ns('__import__("pkg_resources").declare_namespace(__name__)')
    assert has_ns('import pkg_resources; pkg_resources.declare_namespace(__name__)')
    assert has_ns('from pkg_resources import declare_namespace; declare_namespace(__name__)')
