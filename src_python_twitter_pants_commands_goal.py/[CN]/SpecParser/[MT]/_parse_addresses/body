def _parse_addresses(self, spec):
    if spec.endswith('::'):
        dir = self._get_dir(spec[:(- len('::'))])
        for buildfile in BuildFile.scan_buildfiles(self._root_dir, os.path.join(self._root_dir, dir)):
            for address in Target.get_all_addresses(buildfile):
                yield address
    elif spec.endswith(':'):
        dir = self._get_dir(spec[:(- len(':'))])
        for address in Target.get_all_addresses(BuildFile(self._root_dir, dir)):
            yield address
    else:
        yield Address.parse(self._root_dir, spec)
