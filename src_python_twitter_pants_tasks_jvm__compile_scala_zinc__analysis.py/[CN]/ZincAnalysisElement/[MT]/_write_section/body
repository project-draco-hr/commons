def _write_section(self, outfile, header, rep, inline_vals=True, rebasings=None):
    'Write a single section.\n\n    Items are sorted, for ease of testing.\n    '

    def rebase(txt):
        for (rebase_from, rebase_to) in rebasings:
            if (rebase_to is None):
                if (rebase_from in txt):
                    return None
            else:
                txt = txt.replace(rebase_from, rebase_to)
        return txt
    rebasings = (rebasings or [])
    items = []
    for (k, vals) in rep.iteritems():
        for v in vals:
            item = rebase(('%s -> %s%s' % (k, ('' if inline_vals else '\n'), v)))
            if item:
                items.append(item)
    items.sort()
    outfile.write((header + ':\n'))
    outfile.write(('%d items\n' % len(items)))
    for item in items:
        outfile.write(item)
        outfile.write('\n')
