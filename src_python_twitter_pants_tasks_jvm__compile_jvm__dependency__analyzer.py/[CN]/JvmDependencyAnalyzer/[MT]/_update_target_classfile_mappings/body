def _update_target_classfile_mappings(self, targets_by_file, targets=None):
    'Update the targets_by_file mapping as new classes are generated by a compiler run.'
    classes_by_target = self._context.products.get_data('classes_by_target')
    targets = (targets or classes_by_target.keys())
    for tgt in targets:
        target_products = classes_by_target.get(tgt)
        if target_products:
            for (_, classes) in target_products.abs_paths():
                for cls in classes:
                    targets_by_file[cls].add(tgt)
