def insert(self, cache_key, build_artifacts):
    "Cache the output of a build.\n\n    If there is an existing set of artifacts for this key they are deleted.\n\n    TODO: Check that they're equal? They might not have to be if there are multiple equivalent\n          outputs.\n\n    cache_key: A CacheKey object.\n    build_artifacts: List of paths to generated artifacts. These must be under pants_workdir.\n    "
    build_artifacts_that_exist = filter((lambda f: os.path.exists(f)), build_artifacts)
    try:
        self.try_insert(cache_key, build_artifacts_that_exist)
    except Exception as e:
        err_msg = ('Error while writing to artifact cache: %s. Deleting, just in case.' % e)
        self.log.error(err_msg)
        try:
            self.delete(cache_key)
        except Exception:
            self.log.debug(('Failed to delete %s on error.' % cache_key.id))
