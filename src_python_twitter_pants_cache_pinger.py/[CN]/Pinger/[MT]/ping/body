def ping(self, netloc):
    "Time a single roundtrip to the netloc.\n\n    Note that we don't use actual ICMP pings, because cmd-line ping is\n    inflexible and platform-dependent, so shelling out to it is annoying,\n    and the ICMP python lib can only be called by the superuser.\n    "
    if (netloc in _global_pinger_memo):
        return _global_pinger_memo[netloc]
    (host, colon, portstr) = netloc.partition(':')
    port = (int(portstr) if portstr else None)
    rt_secs = Pinger.UNREACHABLE
    for _ in xrange(self._tries):
        try:
            with Timer() as timer:
                conn = httplib.HTTPConnection(host, port, timeout=self._timeout)
                conn.request('HEAD', '/')
                conn.getresponse()
            new_rt_secs = timer.elapsed
        except IOError:
            new_rt_secs = Pinger.UNREACHABLE
        rt_secs = min(rt_secs, new_rt_secs)
    _global_pinger_memo[netloc] = rt_secs
    return rt_secs
