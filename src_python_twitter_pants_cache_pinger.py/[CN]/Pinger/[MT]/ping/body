def ping(self, netloc):
    "Time a single roundtrip to the netloc.\n\n    Note that we don't use actual ICMP pings, because cmd-line ping is\n    inflexible and platform-dependent, so shelling out to it is annoying,\n    and the ICMP python lib can only be called by the superuser.\n    "
    if (netloc in _global_pinger_cache):
        return _global_pinger_cache[netloc]
    (host, colon, portstr) = netloc.partition(':')
    port = (int(portstr) if portstr else None)
    try:
        with Timer() as timer:
            conn = httplib.HTTPConnection(host, port, timeout=1)
            conn.request('HEAD', '/')
            conn.getresponse()
        rt_secs = timer.elapsed
    except socket.timeout:
        rt_secs = Pinger.UNREACHABLE
    _global_pinger_cache[netloc] = rt_secs
    return rt_secs
