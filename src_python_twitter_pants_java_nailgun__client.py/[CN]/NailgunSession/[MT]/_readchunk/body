def _readchunk(self, buffer):
    while (len(buffer) < HEADER_LENGTH):
        buffer += self._sock.recv(BUFF_SIZE)
    (payload_length, command) = struct.unpack(HEADER_FMT, buffer[:HEADER_LENGTH])
    buffer = buffer[HEADER_LENGTH:]
    while (len(buffer) < payload_length):
        buffer += self._sock.recv(BUFF_SIZE)
    payload = buffer[:payload_length]
    rest = buffer[payload_length:]
    return (command, payload, rest)
