def _calculate_sources(self, thrift_targets):
    bases = set()
    sources = set()

    def collect_sources(target):
        if self.is_gentarget(target):
            bases.add(target.target_base)
            sources.update(target.sources_relative_to_buildroot())
    for target in thrift_targets:
        target.walk(collect_sources)
    return (bases, sources)
