{
  AtomicLong longVar=root.registerLong("long");
  MetricRegistry barScope=root.scope("bar");
  Rate longRate=Rate.of("long",longVar,clock);
  barScope.register(longRate);
  Rate longRateRate=Rate.of(longRate,clock);
  root.register(longRateRate);
  checkSamples(ImmutableMap.<String,Number>of("long",0L,"bar." + longRate.getName(),0d,longRateRate.getName(),0d));
  clock.advance(ONE_SECOND);
  longVar.addAndGet(10);
  checkSamples(ImmutableMap.<String,Number>of("long",10L,"bar." + longRate.getName(),10d,longRateRate.getName(),10d));
  clock.advance(ONE_SECOND);
  longVar.addAndGet(2);
  checkSamples(ImmutableMap.<String,Number>of("long",12L,"bar." + longRate.getName(),2d,longRateRate.getName(),-8d));
}
