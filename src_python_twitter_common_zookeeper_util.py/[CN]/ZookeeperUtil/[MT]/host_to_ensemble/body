@staticmethod
def host_to_ensemble(host):
    'Given a host or host:port pair, return a zookeeper-compatible ensemble string.'
    import socket

    def convert_ensemble(ensemble):
        ensemble = ensemble.split(':')
        if (len(ensemble) == 1):
            (ensemble_host, port) = (ensemble, 2181)
        elif (len(ensemble) == 2):
            (ensemble_host, port) = (ensemble[0], int(ensemble[1]))
        else:
            raise ValueError(('Unrecognized ensemble: %s' % ':'.join(ensemble)))
        (_, _, ensemble) = socket.gethostbyname_ex(ensemble_host)
        return (('%s:%s' % (host, port)) for host in ensemble)
    return ','.join(itertools.chain(*(convert_ensemble(ensemble) for ensemble in host.split(','))))
