@staticmethod
def clean_tree(zh, root):
    'Recursively removes the zookeeper subtree underneath :root given zookeeper handle :zh.'
    try:
        if (not zookeeper.exists(zh, root)):
            return True
        for child in zookeeper.get_children(zh, root):
            if (not ZookeeperUtil.clean_tree(zh, posixpath.join(root, child))):
                return False
        zookeeper.delete(zh, root)
    except zookeeper.ZooKeeperException as e:
        return False
    return True
