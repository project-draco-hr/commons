def calculate_sources(self, targets):
    sources = defaultdict(set)

    def collect_sources(target):
        src = (os.path.join(target.target_base, source) for source in target.sources if source.endswith('.java'))
        if src:
            sources[target].update(src)
    for target in targets:
        collect_sources(target)
    return (sources, Target.identify(targets))
