{
  String message=getMessage(diagnostic);
  CharSequence sourceCode=extractSource(diagnostic);
  if (sourceCode == null) {
    out.println(ansi.format("%s%s",includeSourceInfo ? kindMessage(diagnostic) : "",message));
  }
 else {
    out.println(ansi.format("%s%s\n%s\n%s^",includeSourceInfo ? String.format("%s:%d: %s",diagnostic.getSource().toUri().getPath(),diagnostic.getLineNumber(),kindMessage(diagnostic)) : "",message,sourceCode,spaces((int)diagnostic.getColumnNumber() - 1)));
  }
  out.print(Ansi.ansi().reset());
  out.flush();
}
