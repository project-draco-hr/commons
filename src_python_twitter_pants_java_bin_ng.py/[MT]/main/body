def main(args):
    options = app.get_options()
    if options.show_help:
        app.help()
    if (options.show_version or options.just_version):
        print(('Python NailGun client version %s' % VERSION))
        if options.just_version:
            sys.exit(0)
    command = re.compile('.pex$').sub('', os.path.basename(sys.argv[0]))
    args_index = 0
    if (command == 'ng'):
        if (not args):
            app.help()
        command = args[0]
        args_index = 1
    ng = NailgunClient(host=options.ng_host, port=options.ng_port)
    try:
        result = ng(command, *args[args_index:], **os.environ)
        sys.exit(result)
    except ng.NailgunError as e:
        print(('Problem executing command: %s' % e), file=sys.stderr)
        sys.exit(1)
