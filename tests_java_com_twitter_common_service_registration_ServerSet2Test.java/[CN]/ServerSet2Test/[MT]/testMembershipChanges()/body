{
  ServerSet client=createServerSet();
  client.setListener(serverSetListener);
  assertConnected(false);
  assertConnected(true);
  ServerSet ss1=createServerSet();
  ServerSet ss2=createServerSet();
  ServerSet ss3=createServerSet();
  ss1.join(createServer(11));
  assertChangeFired(11);
  ss2.join(createServer(22));
  assertChangeFired(11,22);
  expireSession(((ZkServerSet)client).getZkClient());
  assertConnected(false);
  ss3.join(createServer(33));
  assertChangeFired(11,22,33);
  assertConnected(true);
  ss1.unjoin(createServer(11));
  assertChangeFired(22,33);
  ss3.unjoin(createServer(33));
  assertChangeFired(22);
  ss2.unjoin(createServer(22));
  assertChangeFiredEmpty();
  assertTrue(eventQ.isEmpty());
}
